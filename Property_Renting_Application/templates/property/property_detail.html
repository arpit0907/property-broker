{% extends 'base.html' %}
{% load widget_tweaks %}
{% load static %}
{% block content %}

 <h2>Details</h2>
{% if request.user.profile.roles == "Owner" %}
    Name:    {{ object.name }}<br>
    City:    {{ object.city }}<br>
    Address: {{ object.address }}<br>
    Size:    {{ object.size}}<br>
    Prize    {{ object.prize}}<br>
    Created by:  {{ object.created_by}}<br>

    {% if object.property_img  %}
        <img src="{{ object.property_img.url }}" width="400" height="200">
    {% endif %}

{% endif %} 
{% if request.user.profile.roles == "Renter" %}
    Name:    {{ object.name }}<br>
    City:    {{ object.city }}<br>
    Address: {{ object.address }}<br>
    Size:    {{ object.size}}<br>
    Prize    {{ object.prize}}<br>
    Created by:  {{ object.created_by}}<br>

    {% if object.property_img  %}
        <img src="{{ object.property_img.url }}" width="400" height="200">
    {% endif %}

    <button type="button" id="intrested_renter" data-id="{{property.id}}" data-user_id="{{request.user.id}}" data-url="{% url 'property:property-renter-intreted' %}" >Apply</button>
    
{% endif %}

{% endblock %}
 {% block script %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">

$(document).ready( function() { 

       $("#intrested_renter").on('click',function(e){
        e.preventDefault();
        
        
        var url = $(this).data('url');
        var property_id = $(this).data('id');
        var user_id = $(this).data('user_id');

        $.ajax({
        type: "POST",
        url: url,
        headers:{
            "X-CSRFToken": '{{csrf_token}}' 
        },
        dataType: "json",
        data: {"property_id":property_id,"user_id":user_id},
        success: function(response) {
                if(response.created == true){
                   alert('Successfully applied')

                }else{
                    alert('already applied')
                }

         }
        });
    });
});

</script>

{% endblock %}

</body>
</html>